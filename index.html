import React, { useEffect, useState } from 'react';

const LinkEmbed = () => {
  const [embedUrl, setEmbedUrl] = useState('');

  useEffect(() => {
    // Extract the link parameter from the URL
    const params = new URLSearchParams(window.location.search);
    const linkParam = params.get('link');
    
    if (linkParam) {
      try {
        // Decode the URL parameter and validate it
        const decodedUrl = decodeURIComponent(linkParam);
        const urlObj = new URL(decodedUrl);
        setEmbedUrl(urlObj.toString());
      } catch (e) {
        console.error('Invalid URL provided:', e);
        setEmbedUrl('');
      }
    }
  }, []);

  if (!embedUrl) {
    return (
      <div className="w-full max-w-[600px] p-4 border border-red-300 rounded bg-red-50 text-red-700">
        No valid URL provided in the link parameter
      </div>
    );
  }

  return (
    <div className="w-full max-w-[600px] overflow-hidden">
      <div className="relative w-full pb-[56.25%]">
        <iframe
          src={embedUrl}
          className="absolute top-0 left-0 w-full h-full border-0"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
          allowFullScreen
          title="Web Embed"
        />
      </div>
    </div>
  );
};

export default LinkEmbed;
